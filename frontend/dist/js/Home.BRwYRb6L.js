import{d as C,t as m,k as w,v as A,u as F,l as D,m as s,a as u,w as f,x as T,r as y,o as p,y as b,z as H,c as k,p as I,A as L,B as S,C as B,F as E}from"./vendor.b7dnWdBk.js";import{a as $,h as P}from"./index.D4oiYhMT.js";import{T as z}from"./TopBar.B5C0Mg6G.js";import{S as N}from"./SideContent.boZNwz8F.js";const R="data:image/svg+xml,%3c?xml%20version='1.0'%20standalone='no'?%3e%3c!DOCTYPE%20svg%20PUBLIC%20'-//W3C//DTD%20SVG%201.1//EN'%20'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3e%3csvg%20t='1740278208157'%20class='icon'%20viewBox='0%200%201024%201024'%20version='1.1'%20xmlns='http://www.w3.org/2000/svg'%20p-id='3636'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20width='200'%20height='200'%3e%3cpath%20d='M512%20512m-439.36%200a439.36%20439.36%200%201%200%20878.72%200%20439.36%20439.36%200%201%200-878.72%200Z'%20fill='%239CDCF8'%20p-id='3637'%3e%3c/path%3e%3cpath%20d='M598.45%20392.63a23%2023%200%200%200-46.05-1h-0.21l-76%20241.29a23%2023%200%201%200%2045.79%203.72h0.21l76-241.29a22.82%2022.82%200%200%200%200.26-2.72zM412.18%20369.55a23%2023%200%200%200-23%2022H389l0.14%20127L319%20448.52l-0.19%200.19-70.32-70.32a23.26%2023.26%200%200%200-1.7-2.07%2023%2023%200%200%200-17.48-6.71c-0.51%200-1-0.06-1.53-0.06a23%2023%200%200%200-23%2022h-0.21l0.26%20241.29a23%2023%200%201%200%2045.79%203.72h0.21l-0.21-191%2050.55%2050.54%200.18-0.18%2087.41%2087.41%200.37%200.48%200.05%2049a23%2023%200%201%200%2045.82%203.78h0.21L435%20395.3a22.82%2022.82%200%200%200%200.26-2.67%2023.08%2023.08%200%200%200-23.08-23.08zM849.85%20625.57a21.89%2021.89%200%200%200-1.38-2.3l-45.57-94.95%200.24-0.11L731%20382.45l-0.19%200.09a24.32%2024.32%200%200%200-42.12%200l-0.19-0.09-72.17%20145.76%200.23%200.11L571%20623.27a22.07%2022.07%200%200%200-1.38%202.3%2023%2023%200%200%200%2041.06%2020.87l0.18%200.09%2023.71-49.43%20150.19-0.23%2023.83%2049.67%200.18-0.09a23%2023%200%200%200%2041.06-20.87z%20m-193.67-73.51l11-22.85-0.24-0.11%2042.83-86%2042.83%2086-0.24%200.11%2010.88%2022.68z'%20fill='%23FFFFFF'%20p-id='3638'%3e%3c/path%3e%3c/svg%3e",G=C({name:"MainContentItem",props:{data:{type:Object,required:!0}},setup(t){const e=F(),i=m(()=>t.data.path?`http://localhost:3000/${t.data.path}`:R),n=()=>{t.data.id&&e.push({path:`/articles/${t.data.id}`})},c=w(null),o=w(null),a=w(3),r=()=>{if(o.value&&c.value){const g=o.value.offsetTop,v=c.value.offsetHeight,l=parseInt(getComputedStyle(o.value).lineHeight);a.value=Math.floor((v-g)/l)}};return A(()=>{r(),window.addEventListener("resize",r)}),{url:i,imgClick:n,container:c,textContainer:o,maxLines:a}}}),V={class:"main-content-item"},O={class:"item-icon"},U=["src"],j={class:"item-container",ref:"container"},q={class:"item-title"},Y={class:"item-date"};function J(t,e,i,n,c,o){const a=y("el-divider");return p(),D("div",null,[s("div",V,[s("div",O,[s("img",{src:t.url,onClick:e[0]||(e[0]=(...r)=>t.imgClick&&t.imgClick(...r)),alt:"无图片上传"},null,8,U)]),s("div",j,[s("div",q,f(t.data.title),1),s("div",{class:"item-text",ref:"textContainer",style:T({"-webkit-line-clamp":t.maxLines})},f(t.data.summary),5)],512),s("div",Y,f(t.data.date),1)]),u(a)])}const W=$(G,[["render",J],["__scopeId","data-v-b103e3f6"]]),Z=C({name:"MainContent",components:{MainContentItem:W},setup(){const t=b(),e=m(()=>t.getters.getCurrentPage),i=m(()=>t.getters.getArticleCount),n=m(()=>a.value.length>0),c=m(()=>a.value.length>1),o=m(()=>a.value.length>2),a=m(()=>t.getters.getArticleData),r=g=>{console.log("当前页2",e.value),t.commit("setCurrentPage",g)};return H(()=>{const g=document.documentElement.scrollTop||document.body.scrollTop;console.log("滚动位置2",g),t.commit("setScrollPosition",g)}),{articleData:a,currentPage:e,totalPage:i,exist1:n,exist2:c,exist3:o,handleCurrentChange:r}}}),K={class:"main"},Q={class:"pageContent"},X={class:"pageIndex"};function tt(t,e,i,n,c,o){const a=y("main-content-item"),r=y("el-pagination");return p(),D("div",K,[s("div",Q,[t.exist1?(p(),k(a,{key:0,data:t.articleData[0]?t.articleData[0]:{}},null,8,["data"])):I("",!0),t.exist2?(p(),k(a,{key:1,data:t.articleData[1]?t.articleData[1]:{}},null,8,["data"])):I("",!0),t.exist3?(p(),k(a,{key:2,data:t.articleData[2]?t.articleData[2]:{}},null,8,["data"])):I("",!0)]),s("div",X,[u(r,{background:"",layout:"prev, pager, next",onCurrentChange:t.handleCurrentChange,"current-page":t.currentPage,"page-size":3,"pager-count":9,total:t.totalPage},null,8,["onCurrentChange","current-page","total"])])])}const et=$(Z,[["render",tt],["__scopeId","data-v-ab178395"]]),at={class:"main"},nt={class:"content"},ot=C({__name:"HeadContent",setup(t){const e=L({title:"Lifestyle",text:"I am never alone. God and the ancestors are always near by, I AM THAT I AM 🤞🏾",mood:"cool"}),i=m(()=>({height:"200px",backgroundImage:e.mood==="warm"?"linear-gradient(to right, red, orange)":"linear-gradient(to right, cyan, gray)"})),n=()=>{e.mood=e.mood==="warm"?"cool":"warm"};return(c,o)=>(p(),D("div",{style:T(i.value),onClick:n},[s("div",at,f(e.title),1),s("div",nt,f(e.text),1)],4))}}),st=$(ot,[["__scopeId","data-v-509f31bf"]]),ct=C({name:"BottomContent"});function rt(t,e,i,n,c,o){return" @COPYRIGHT-JUSTIN "}const it=$(ct,[["render",rt]]),lt={class:"top"},dt={class:"container"},mt={class:"head"},ut={class:"main"},gt={class:"page"},ht={class:"bottom"},pt=C({__name:"Home",setup(t){const e=b(),i=async()=>{try{const n=await P.get("/catalog/articlesData"),c=e.state.articleCount,o=e.getters.getCurrentPage;console.log("文章总数1",c),console.log("当前页1",o);const a=c-(Number(o)*3-2),r=[];a>=2?r.push(a,a-1,a-2):a>=1?r.push(a,a-1):r.push(a);const v=(await Promise.all(r.map(async l=>{const h=n[l];if(h){const d=(await P.get(`/catalog/articlesData/${h._id}`)).article;return{title:d.title,summary:d.summary,date:d.date,path:d.path,id:d._id,genre:d.genre}}}))).filter(l=>l!==void 0);if(e.commit("setArticleData",v),o===1&&!e.state.recentArticles.length)e.commit("setRecentArticles",v);else if(o===1&&e.state.recentArticles.length){const l=e.state.recentArticles;v.forEach((h,_)=>{if(l[_]==null)e.commit("changeRecentArticles",{index:_,article:h});else{const d=l[_].genre.some(M=>h.genre.some(x=>x.name!==M.name));(l[_].title!==h.title||d)&&e.commit("changeRecentArticles",{index:_,article:h})}})}}catch(n){console.error("获取文章数据失败",n)}};return S([()=>e.getters.getCurrentPage,()=>e.getters.getArticleCount],([n,c],[o,a])=>{n!==o&&(console.log("currentPage 变化了",o,"=>",n),i()),c!==a&&(console.log("articleCount 变化了",a,"=>",c),e.commit("setRecentArticles",[]))},{deep:!0}),A(()=>{e.dispatch("fetchData").then(()=>i()).then(()=>{B(()=>{const n=e.getters.getScrollPosition;console.log("滚动位置1",n),document.documentElement.scrollTo(0,n)})}).catch(n=>{console.error("Failed to fetch data:",n)})}),(n,c)=>{const o=y("el-divider");return p(),D(E,null,[s("div",lt,[u(z,{"in-use1":!0})]),s("div",dt,[s("div",mt,[u(st)]),s("div",ut,[u(o),s("div",gt,[u(et),u(N)])]),s("div",ht,[u(it)])])],64)}}}),$t=$(pt,[["__scopeId","data-v-25e31fba"]]);export{$t as default};
